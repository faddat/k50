<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmos Hub Network Tattoo</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            margin: 0;
            background: radial-gradient(circle at center, #1a0b2e, #0d041a);
            overflow: hidden;
        }
        svg {
            width: 100vw;
            height: 100vh;
        }
        .node {
            transition: all 0.3s ease;
        }
        .link {
            stroke-opacity: 0.3;
            transition: stroke-opacity 0.5s ease;
        }
        .label {
            fill: #ffd700;
            font-family: 'Orbitron', sans-serif;
            font-size: 35px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            cursor: pointer;
            user-select: none;
        }
        .controls {
            position: absolute;
            top: 20px;
            left: 20px;
            font-family: 'Orbitron', sans-serif;
            color: #fff;
        }
        .controls button {
            padding: 10px 15px;
            margin: 0 5px;
            background: rgba(255, 215, 0, 0.2);
            border: 1px solid #ffd700;
            border-radius: 5px;
            color: #ffd700;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .controls button:hover, .controls button.active {
            background: #ffd700;
            color: #1a0b2e;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron&display=swap" rel="stylesheet">
</head>
<body>
    <div class="controls">
        <button class="node-btn" data-nodes="1">1</button>
        <button class="node-btn active" data-nodes="4">4</button>
        <button class="node-btn" data-nodes="69">69</button>
    </div>
    <script>
        // Graph data
        let graph = {};

        // Generate a complete graph Kn
        function generateCompleteGraph(n) {
            graph.vCount = n;
            graph.eCount = (n * (n - 1)) / 2;
            graph.nodes = Array.from({ length: n }, (_, i) => ({
                id: i,
                color: `hsl(${Math.random() * 360}, 80%, 70%)`
            }));
            graph.links = [];
            for (let u = 0; u < n; u++) {
                for (let v = u + 1; v < n; v++) {
                    graph.links.push({ source: u, target: v });
                }
            }
        }

        // SVG setup
        const width = window.innerWidth;
        const height = window.innerHeight;
        const svg = d3.select("body")
            .append("svg")
            .attr("width", width)
            .attr("height", height);

        // Gradient definitions for edges
        const defs = svg.append("defs");
        defs.append("linearGradient")
            .attr("id", "link-gradient")
            .attr("gradientUnits", "userSpaceOnUse")
            .html(`
                <stop offset="0%" stop-color="#ff6f61" stop-opacity="0.5"/>
                <stop offset="50%" stop-color="#ffd700" stop-opacity="0.8"/>
                <stop offset="100%" stop-color="#00c4cc" stop-opacity="0.5"/>
            `);

        // Groups for links and nodes
        const g = svg.append("g").attr("transform", `translate(${width / 2}, ${height / 2})`);
        let link = g.append("g").attr("class", "links").selectAll(".link");
        let node = g.append("g").attr("class", "nodes").selectAll(".node");

        // Label
        const label = svg.append("text")
            .attr("class", "label")
            .attr("x", 50)
            .attr("y", height - 40)
            .text(`Kn = ${graph.vCount}`)
            .on("click", () => {
                generateCompleteGraph(graph.vCount + 1);
                restart();
            });

        // Force simulation
        const simulation = d3.forceSimulation()
            .force("charge", d3.forceManyBody().strength(-100))
            .force("link", d3.forceLink().distance(100).strength(0.1))
            .force("center", d3.forceCenter())
            .force("collision", d3.forceCollide(20))
            .alphaTarget(0.1)
            .on("tick", ticked);

        // Initial graph
        generateCompleteGraph(4); // Start with 4 nodes
        restart();

        function restart() {
            label.text(`Kn = ${graph.vCount}`);

            // Update nodes
            node = node.data(graph.nodes, d => d.id);
            node.exit().transition().duration(500)
                .attr("r", 0)
                .remove();
            node = node.enter().append("circle")
                .attr("class", "node")
                .attr("r", 0)
                .attr("fill", d => d.color)
                .attr("stroke", "#fff")
                .attr("stroke-width", 1)
                .call(node => node.transition().duration(500).attr("r", 8))
                .merge(node)
                .call(d3.drag()
                    .on("start", dragstarted)
                    .on("drag", dragged)
                    .on("end", dragended));

            // Update links
            link = link.data(graph.links, d => `${d.source.id}-${d.target.id}`);
            link.exit().transition().duration(500)
                .attr("stroke-opacity", 0)
                .remove();
            link = link.enter().append("line")
                .attr("class", "link")
                .attr("stroke", "url(#link-gradient)")
                .attr("stroke-width", 1)
                .attr("stroke-opacity", 0)
                .call(link => link.transition().duration(500).attr("stroke-opacity", 0.3))
                .merge(link);

            // Restart simulation
            simulation.nodes(graph.nodes);
            simulation.force("link").links(graph.links);
            simulation.alpha(1).restart();

            // Animate node glow
            node.each(function(d) {
                d3.select(this)
                    .transition()
                    .duration(2000)
                    .ease(d3.easeSinInOut)
                    .attr("r", 12)
                    .style("filter", "drop-shadow(0 0 5px currentColor)")
                    .transition()
                    .duration(2000)
                    .attr("r", 8)
                    .style("filter", "none")
                    .on("end", function() { d3.select(this).transition().call(arguments.callee); });
            });
        }

        function ticked() {
            node.attr("cx", d => d.x).attr("cy", d => d.y);
            link.attr("x1", d => d.source.x)
                .attr("y1", d => d.source.y)
                .attr("x2", d => d.target.x)
                .attr("y2", d => d.target.y);
        }

        function dragstarted(d) {
            if (!d3.event.active) simulation.alphaTarget(0.3).restart();
            d.fx = d.x;
            d.fy = d.y;
        }

        function dragged(d) {
            d.fx = d3.event.x;
            d.fy = d3.event.y;
        }

        function dragended(d) {
            if (!d3.event.active) simulation.alphaTarget(0);
            d.fx = null;
            d.fy = null;
        }

        // Node count controls
        d3.selectAll(".node-btn").on("click", function() {
            const n = parseInt(this.dataset.nodes);
            d3.selectAll(".node-btn").classed("active", false);
            d3.select(this).classed("active", true);
            generateCompleteGraph(n);
            restart();
        });

        // Resize handling
        window.addEventListener("resize", () => {
            svg.attr("width", window.innerWidth)
               .attr("height", window.innerHeight);
            simulation.force("center", d3.forceCenter(window.innerWidth / 2, window.innerHeight / 2));
            simulation.alpha(1).restart();
        });
    </script>
</body>
</html>
